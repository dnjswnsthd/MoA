<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.moa.model.mapper.MemberMapper">
	<!-- member login -->
	<select id="login" parameterType="MemberDto" resultType="MemberDto">
		select id, name
		from member
		where id = #{id} and pw = #{pw}
	</select>
	
	
	<!-- ID 중복 검사 -->
	<select id="idChk" resultType="int" parameterType="String">
		select count(*) from member where id=#{id}
	</select>
	
	<!-- member join -->
	<!-- 회원가입 -->
	<insert id="join" parameterType="Map">
		insert into member
		(id,pw,name,age,major,status,phone,favorite_1,favorite_2,favorite_3,introduce)
		values
		(#{id},#{pw},#{name},#{age},#{major},#{status},#{phone},#{favorite_1},#{favorite_2},#{favorite_3},#{introduce})

	</insert>
	<!-- 멘토일 경우 추가되는 정보 insert -->
	<insert id="joinMentor" parameterType="Map">
		insert into mentor(id, career)
		values(#{id}, #{career})
	</insert>
	<!-- 멘티일 경우 추가되는 정보 insert -->
	<insert id="joinMentee" parameterType="Map">
		insert into mentee(id, skill)
		values(#{id}, #{skill})
	</insert>
	
	<!--  member search -->
	<select id="memberSearch" parameterType="MemberDto" resultType="MemberDto">
		select id
		from member
		where id = #{id} and pw = #{pw}
	</select>
	
	
	<!--  member update -->
	<update id="memberUpdate" parameterType="MemberDto">
		update member set
		pw = #{pw},
		name = #{name},
		age = #{age},
		major = #{major},
		phone = #{phone},
		favorite_1 = #{favorite_1},
		favorite_2 = #{favorite_2},
		favorite_3 = #{favorite_3},
		introduce = #{introduce}
		where id = #{id}
	</update>
	
	<!-- member delete -->
	<!-- member 삭제를 하면 Cascade 를 통해 mentor와  mentee 도 함께 삭제 된다. -->
	<delete id="delete" parameterType="String">
		delete from member
		where id = #{id} and pw = {pw}
	</delete>
	
	<!-- 임시 비밀번호로 비밀번호를 바꾸기 -->
	<update id="updateTempPassword" parameterType="Map">
		update member set
		pw = #{pw}
		where id = #{id}
	</update>
</mapper>